{
  "flow_type": "template",
  "flow_name": "profile_about",
  "status": "released",
  "rows": [
    {
      "type": "begin_template",
      "name": "header",
      "value": "section_header",
      "action_list": "uncompleted | emit: uncompleted; ",
      "exclude_from_translation": true
    },
    {
      "name": "section_id",
      "value": "about",
      "exclude_from_translation": true
    },
    {
      "name": "section_data",
      "value": "profile_section",
      "exclude_from_translation": true
    },
    {
      "type": "end_template",
      "exclude_from_translation": true
    },
    {
      "exclude_from_translation": true
    },
    {
      "type": "text",
      "name": "choose_role",
      "value": "@global.choose_role",
      "parameter_list": "style: emphasised;",
      "exclude_from_translation": true
    },
    {
      "type": "combo_box",
      "name": "user_type_select",
      "value": "@fields.user_type",
      "parameter_list": "answer_list: @data.user_type;\nplaceholder: @global.select_response;\nvariant: dropdown;",
      "exclude_from_translation": true
    },
    {
      "name": "completed_enabled",
      "value": "!!@local.user_type_select",
      "exclude_from_translation": true
    },
    {
      "exclude_from_translation": true
    },
    {
      "type": "text",
      "name": "choose_org",
      "value": "@global.choose_organisation",
      "parameter_list": "style: emphasised;",
      "exclude_from_translation": true
    },
    {
      "type": "combo_box",
      "name": "user_org_select",
      "value": "@fields.user_organisation",
      "parameter_list": "answer_list: @data.user_organisation;\nplaceholder: @global.select_response;\nvariant: dropdown;",
      "exclude_from_translation": true
    },
    {
      "name": "completed_enabled_2",
      "value": "!!@local.user_org_select",
      "exclude_from_translation": true
    },
    {
      "exclude_from_translation": true
    },
    {
      "type": "text",
      "name": "choose_region",
      "value": "@global.choose_region",
      "parameter_list": "style: emphasised;",
      "exclude_from_translation": true
    },
    {
      "name": "user_region_select",
      "exclude_from_translation": true
    },
    {
      "type": "combo_box",
      "name": "user_region_select",
      "value": "@fields.user_region",
      "parameter_list": "answer_list: @data.user_region;\nplaceholder: @global.select_response;\nvariant: dropdown;",
      "exclude_from_translation": true
    },
    {
      "type": "text",
      "name": "choose_province",
      "value": "@global.choose_province",
      "parameter_list": "style: emphasised;",
      "exclude_from_translation": true
    },
    {
      "name": "province_disabled_text",
      "value": "@global.no_region"
    },
    {
      "name": "province_count"
    },
    {
      "type": "data_items",
      "name": "count_provinces_in_region",
      "value": "@data.user_province",
      "action_list": "data_changed | set_local : province_count : @items.length",
      "parameter_list": "filter: @item.region_id == @local.user_region_select; limit: 1",
      "hidden": true,
      "comments": "can stop counting when one is found"
    },
    {
      "name": "province_disabled_text",
      "value": "@global.region_without_province",
      "condition": "@local.province_count === 0 && !!@local.user_region_select"
    },
    {
      "name": "user_province_select",
      "exclude_from_translation": true
    },
    {
      "type": "begin_combo_box",
      "name": "user_province_select",
      "value": "@fields.user_province",
      "parameter_list": "placeholder: @global.select_response;\ndisabled_text: @local.province_disabled_text;\nvariant: dropdown;",
      "exclude_from_translation": true
    },
    {
      "type": "data_items",
      "value": "user_province",
      "parameter_list": "filter: @item.region_id == @local.user_region_select",
      "hidden": true
    },
    {
      "type": "end_combo_box",
      "exclude_from_translation": true
    },
    {
      "type": "text",
      "name": "choose_city",
      "value": "@global.choose_city",
      "parameter_list": "style: emphasised;",
      "exclude_from_translation": true
    },
    {
      "name": "city_disabled_text",
      "value": "@global.no_province"
    },
    {
      "name": "city_count"
    },
    {
      "type": "data_items",
      "name": "count_cities_in_province",
      "value": "@data.user_city",
      "action_list": "data_changed | set_local : city_count : @items.length",
      "parameter_list": "filter: @item.province_id == @local.user_province_select; limit: 1",
      "hidden": true,
      "comments": "can stop counting when one is found"
    },
    {
      "name": "city_disabled_text",
      "value": "@global.province_without_city",
      "condition": "@local.city_count === 0 && !!@local.user_province_select"
    },
    {
      "name": "user_city_select",
      "exclude_from_translation": true
    },
    {
      "type": "begin_combo_box",
      "name": "user_city_select",
      "value": "@fields.user_city",
      "parameter_list": "placeholder: @global.select_response;\ndisabled_text: @local.city_disabled_text;\nvariant: dropdown;",
      "exclude_from_translation": true
    },
    {
      "type": "data_items",
      "value": "user_city",
      "parameter_list": "filter: @item.province_id == @local.user_province_select",
      "hidden": true
    },
    {
      "type": "end_combo_box",
      "exclude_from_translation": true
    },
    {
      "type": "begin_display_group",
      "name": "dg_bottom",
      "parameter_list": "sticky: bottom;",
      "style_list": "padding: 12px 24px;"
    },
    {
      "type": "button",
      "name": "save",
      "value": "Save",
      "action_list": "click | set_field: user_type: @local.user_type_select;\nclick | set_field: user_organisation: @local.user_org_select;\nclick | set_field: user_region: @local.user_region_select;\nclick | set_field: user_province: @local.user_province_select;\nclick | set_field: user_city: @local.user_city_select;\nclick | emit:completed;"
    },
    {
      "type": "end_display_group"
    }
  ]
}